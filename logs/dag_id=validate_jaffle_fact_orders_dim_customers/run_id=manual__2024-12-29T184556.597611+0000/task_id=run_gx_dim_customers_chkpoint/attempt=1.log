[2024-12-29T18:46:24.220+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: validate_jaffle_fact_orders_dim_customers.run_gx_dim_customers_chkpoint manual__2024-12-29T18:45:56.597611+00:00 [queued]>
[2024-12-29T18:46:24.242+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: validate_jaffle_fact_orders_dim_customers.run_gx_dim_customers_chkpoint manual__2024-12-29T18:45:56.597611+00:00 [queued]>
[2024-12-29T18:46:24.243+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-12-29T18:46:24.284+0000] {taskinstance.py:2217} INFO - Executing <Task(GreatExpectationsOperator): run_gx_dim_customers_chkpoint> on 2024-12-29 18:45:56.597611+00:00
[2024-12-29T18:46:24.337+0000] {standard_task_runner.py:60} INFO - Started process 213 to run task
[2024-12-29T18:46:24.345+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'validate_jaffle_fact_orders_dim_customers', 'run_gx_dim_customers_chkpoint', 'manual__2024-12-29T18:45:56.597611+00:00', '--job-id', '111', '--raw', '--subdir', 'DAGS_FOLDER/snow_jaffle_gx_validate.py', '--cfg-path', '/tmp/tmp78avm6fr']
[2024-12-29T18:46:24.348+0000] {standard_task_runner.py:88} INFO - Job 111: Subtask run_gx_dim_customers_chkpoint
[2024-12-29T18:46:24.449+0000] {task_command.py:423} INFO - Running <TaskInstance: validate_jaffle_fact_orders_dim_customers.run_gx_dim_customers_chkpoint manual__2024-12-29T18:45:56.597611+00:00 [running]> on host a68ea757822e
[2024-12-29T18:46:24.559+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='validate_jaffle_fact_orders_dim_customers' AIRFLOW_CTX_TASK_ID='run_gx_dim_customers_chkpoint' AIRFLOW_CTX_EXECUTION_DATE='2024-12-29T18:45:56.597611+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2024-12-29T18:45:56.597611+00:00'
[2024-12-29T18:46:24.561+0000] {great_expectations.py:580} INFO - Running validation with Great Expectations...
[2024-12-29T18:46:24.562+0000] {great_expectations.py:582} INFO - Instantiating Data Context...
[2024-12-29T18:46:24.908+0000] {file_data_context.py:222} INFO - FileDataContext loading fluent config
[2024-12-29T18:46:24.942+0000] {config.py:185} INFO - Loading 'datasources' ->
[{'assets': [...],
  'connection_string': 'snowflake://mds_user:password123@bx93159.europe-west3.gcp/mds_prod/CORE?warehouse=mds_warehouse&role=mds_role',
  'name': 'my_jaffle_shop_source',
  'type': 'snowflake'}]
[2024-12-29T18:46:25.312+0000] {abstract_data_context.py:5504} INFO - Loaded 'my_jaffle_shop_source' from fluent config
[2024-12-29T18:46:25.315+0000] {file_data_context.py:174} INFO - Saving 1 Fluent Datasources to /opt/***/ge/gx/great_expectations.yml
[2024-12-29T18:46:25.317+0000] {fluent_base_model.py:276} INFO - SplitterColumnValue.dict() - missing `config_provider`, skipping config substitution
[2024-12-29T18:46:25.318+0000] {fluent_base_model.py:276} INFO - TableAsset.dict() - missing `config_provider`, skipping config substitution
[2024-12-29T18:46:25.319+0000] {fluent_base_model.py:276} INFO - TableAsset.dict() - missing `config_provider`, skipping config substitution
[2024-12-29T18:46:25.320+0000] {fluent_base_model.py:276} INFO - SnowflakeDatasource.dict() - missing `config_provider`, skipping config substitution
[2024-12-29T18:46:25.490+0000] {great_expectations.py:598} INFO - Creating Checkpoint...
[2024-12-29T18:46:25.500+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/great_expectations/data_context/store/tuple_store_backend.py", line 320, in _get
    with open(filepath) as infile:
FileNotFoundError: [Errno 2] No such file or directory: '/opt/airflow/ge/gx/checkpoints/dim_customers_checkpoint.yml'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/great_expectations/data_context/store/checkpoint_store.py", line 154, in get_checkpoint
    checkpoint_config: Optional[Any] = self.get(key=key)
  File "/home/airflow/.local/lib/python3.10/site-packages/great_expectations/data_context/store/store.py", line 207, in get
    value = self._store_backend.get(self.key_to_tuple(key))
  File "/home/airflow/.local/lib/python3.10/site-packages/great_expectations/data_context/store/_store_backend.py", line 123, in get
    value = self._get(key, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/great_expectations/data_context/store/tuple_store_backend.py", line 323, in _get
    raise InvalidKeyError(
great_expectations.exceptions.exceptions.InvalidKeyError: Unable to retrieve object from TupleFilesystemStoreBackend with the following Key: /opt/***/ge/gx/checkpoints/dim_customers_checkpoint.yml

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/great_expectations_provider/operators/great_expectations.py", line 601, in execute
    self.checkpoint = self.data_context.get_checkpoint(name=self.checkpoint_name)
  File "/home/airflow/.local/lib/python3.10/site-packages/great_expectations/data_context/data_context/abstract_data_context.py", line 1998, in get_checkpoint
    checkpoint_config: CheckpointConfig = self.checkpoint_store.get_checkpoint(
  File "/home/airflow/.local/lib/python3.10/site-packages/great_expectations/data_context/store/checkpoint_store.py", line 159, in get_checkpoint
    raise gx_exceptions.CheckpointNotFoundError(
great_expectations.exceptions.exceptions.CheckpointNotFoundError: Non-existent Checkpoint configuration named "dim_customers_checkpoint".

Details: Unable to retrieve object from TupleFilesystemStoreBackend with the following Key: /opt/***/ge/gx/checkpoints/dim_customers_checkpoint.yml
[2024-12-29T18:46:25.524+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=validate_jaffle_fact_orders_dim_customers, task_id=run_gx_dim_customers_chkpoint, execution_date=20241229T184556, start_date=20241229T184624, end_date=20241229T184625
[2024-12-29T18:46:25.543+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 111 for task run_gx_dim_customers_chkpoint (Non-existent Checkpoint configuration named "dim_customers_checkpoint".

Details: Unable to retrieve object from TupleFilesystemStoreBackend with the following Key: /opt/***/ge/gx/checkpoints/dim_customers_checkpoint.yml; 213)
[2024-12-29T18:46:25.602+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-12-29T18:46:25.626+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
